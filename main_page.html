<!DOCTYPE html>
<html>
<head>
<meta charset = "utf-8" name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Cybersecurity Dinner Adventure</title>
<!-- Need the link tag to solve an error with favicon.ico: https://stackoverflow.com/questions/31075893/im-getting-favicon-ico-error -->
<link rel="shortcut icon" href="#"/>
<style>
  /* style for entire webpage */

  body {
    background-color: black;
    text-align: center;
    color: white;
    font-family: courier;
  }

  /* style for guide hyperlinks */
  a
  {
    color: rgb(123, 213, 255);
  }

  /* style for blinking start screen */
  /* source: https://www.freecodecamp.org/news/make-it-blink-html-tutorial-how-to-use-the-blink-tag-with-code-examples/ */
  #blinkingStartScreen {
    animation: blink 1s steps(1, end) infinite;

    /* for positioning the start screen image with text */
    width: 700px;
    height: 500px;
    position: absolute;
    visibility: visible;
  }

  @keyframes blink {
  0% {
    opacity: 1;
  }
  50% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}

  /* source for how to style an element by id: https://blog.hubspot.com/website/css-id */
  /* style for scrolling text box (i.e. terminal) */
  #myTerminal {
    background-color: rgb(0, 8, 8);
    color: white;
    width: 605px;
    height: 377px;
    overflow-y: scroll;
    position: absolute;
    visibility: hidden;
    text-align: left;
    word-break: break-all;  /* allows wraparound without spaces - https://css-tricks.com/almanac/properties/o/overflow-wrap/*/
  }

  /* style the terminal files with respect to linux color code: https://www.2daygeek.com/understanding-the-color-code-of-linux-files/ */
  /* text: white , directory: blue, executable: green */
  .executable_file {
    color: limegreen;
  }
  .subdirectory {
    color: mediumblue;
  }

  /* source for how to style tab-related elements: https://www.w3schools.com/howto/howto_js_vertical_tabs.asp*/
  /* style the tab */
  .tab {
    float: left;
    border: 1px solid #ccc;
    background-color: #f1f1f1;

    width: 200px; /* width of tab */
    height: 500px; /* make the same as game canvas' height */
    position: absolute;
    visibility: hidden;
  }

  /* style the buttons inside the tab */
  .tab button {
    display: block;
    background-color: inherit;
    color: black;
    padding: 22px 16px;
    width: 100%;
    border: none;
    outline: none;
    text-align: left;
    cursor: pointer;
    font-size: 17px;
  }

  /* change background color of buttons on hover */
  .tab button:hover {
    background-color: #ddd;
  }

  /* create an active/current "tab button" class */
  .tab button.active {
    background-color: #ccc;
  }

  /* style the tab content */
  .tabcontent {
    float: left;
    padding: 0px 12px;
    border: 1px solid #ccc;
    border-left: none;

    width: 500px; /* width of tab content */
    height: 500px;  /* make the same as game canvas' height */
    position: absolute;

    visibility: hidden;
    background-color: white;
    color:black;
    text-align: left;
  }

  /* source for styling button: https://www.w3schools.com/css/css3_buttons.asp */
  .button {
    position: absolute;
    top: 90%;
    left: 50%;
    transform: translate(-50%, -50%);
    
    background-color: rgb(181, 255, 207);
    color: black;
    font-size: 16px;
    padding: 16px 30px;
    border: none;
    cursor: pointer;
    border-radius: 5px;
    text-align: center;
  }

  /* style the button on hover */
  .button:hover {
    background-color: rgb(168, 240, 194);
  }

  /* style for the list of hints */
  .hint_list {
    color: black;
    width: 500px;
    height: 300px;
    overflow-y: scroll;
    visibility: hidden;
    text-align: left;
  }

  /* source for display parameter: https://stackoverflow.com/questions/2928688/how-to-hide-elements-without-having-them-take-space-on-the-page */
  /* style for elements that show up while game is ongoing */
  .ongoing {
    visibility: visible;
    display: block;
  }
  iframe {
    position : relative;
    /* top : 100px;
    left : 100px; */
  }
  /* style for elements that show up when the game is complete */
  .complete {
    visibility: hidden;
    display: none;
  }
</style>
</head>

<!-- BEGINNING OF ELEMENTS DISPLAYED ON HTML PAGE -->
<h1>Cybersecurity Dinner Adventure</h1>
<!-- this element follows the style of the "ongoing" class--shows up while the game is ongoing -->
<p class="ongoing">Instructions: Use the arrow keys to navigate locations and complete your tasks. If you find yourself at a pop-up screen within the game, press Escape to close it and return to the overworld. For text-based prompts, hit Enter to submit your input.</p>
<!-- these elements follow the style of the "complete" class--shows up once the game is complete -->
<h2 class="complete">CONGRATULATIONS!</h2>
<p class="complete">You've completed all the cybersecurity puzzles that need to be solved in order to make breakfast.</p>
<br class="complete">

<!-- creating blinking effect for start screen -->
<!-- source: https://stackoverflow.com/questions/27427073/how-to-fit-in-an-image-inside-span-tag -->
<!-- <span id="blinkingStartScreen">
  <img src="images/delete.png"/>
</span> -->
<!-- creating the canvas -->

<canvas id="myCanvas" width="700" height="500" style="background-color: #f1f1f1;"></canvas>
<br>
<iframe id="myIFrame" src="if.html" title="example of iframes" height="500" width="700" hidden="hidden">

  <p>Your browser does not support iframes.</p>
</iframe>
<body onload="start()">
<script>
  const game_canvas = document.getElementById("myCanvas");
  const game_context = game_canvas.getContext("2d");
  const my_iframe = document.getElementById("myIFrame");
  let scene_pic;
  function start() {
    scene_pic = loadBackground("images/main_page_map.png");

    setInterval(update, 20)  // infinite loop, runs every 2 ms

  }


  /**
   * Initial loading of background (image takes up the entire canvas space).
   * Loads the image into the page. Must be called prior to drawing or will face the problem
   * of the image not always displaying when the page is opened/refreshed.
   * 
   * @param img_url String representing the path to the image
   * @return Object representing the background image
   */
   function loadBackground(img_url) {
    const background_img = new Image();
    background_img.src = img_url;

    // load images first
    // - Note: the following line is needed to fix the problem of the background img not always
    // displaying when the page is refreshed
    // - Source: https://stackoverflow.com/questions/22889641/simple-html5-canvas-image-not-displaying
    background_img.addEventListener("load", drawBackground, false);

    function drawBackground() {}
    return background_img;
  }
  
  //function with purpose:
  //on some action (click on canvas), switches canvas to an iframe in that exact position
  //on repeat of that action (reclick on iframe), switches canvas back in (do I have to write up code for a new iframe for this?)

  //ultimate goals, broken down:
  //on mouseclick in one of four places, trigger hiding of this and display of an iframe
  // iframe has two buttons overlayed that then can be used to toggle values
  // OR, iframe sends events to parent (document) which then captures those events and uses them to make canvas visible and iframe invisible
  // which is better? buttons = uniformity, but can get in the way. Easy to use across iframes though. 
  // OTOH, events are more flexible
  game_canvas.addEventListener("mousedown", e => {
    //goal: make canvas invisible
    // create an iframe
    let not_vis = game_canvas.getAttribute("hidden");
if (!not_vis) {
   game_canvas.setAttribute("hidden", "hidden");
   my_iframe.removeAttribute("hidden");
}
})

document.addEventListener("IframeClickEvent", e => {
  console.log("recieved!");
  let not_vis = game_canvas.getAttribute("hidden");
  if (not_vis) {
    game_canvas.removeAttribute("hidden");
    my_iframe.setAttribute("hidden", "hidden");
  }
})

// my_iframe.addEventListener("mousedown", e => {
//     //goal: make canvas invisible
//     // create an iframe
//     let not_vis = game_canvas.getAttribute("hidden");
// if (not_vis) {
//    game_canvas.removeAttribute("hidden");
//    my_iframe.setAttribute("hidden", "hidden");
//    //remove iframe
// }
// })

  /**
   * Draws the image in the specified location. Is needed for redrawing images in the
   * infinite loop that updates the game visuals.
   * 
   * @param img Object representing the image
   * @param x Integer representing the x-coordinate of where the image should be positioned in the canvas
   * @param y Integer representing the y-coordinate of where the image shoudl be positioned in the canvas
   * @param width Integer representing the width of the image
   * @param height Integer representing the height of the image
   */
   function draw(img, x, y, width, height) {
    game_context.drawImage(img, sx=x, sy=y, swidth=width, sheight=height);
  }


  /**
   * Updates game visuals and stats.
   */
  function update() {
    // step 1 - clear the canvas
    clearCanvas();
    draw(scene_pic, 0, 0, 700, 500);
  }


  function clearCanvas() {
    // clears everything on the canvas
    game_context.clearRect(0, 0, 700, 500);
  }
</script>

<!-- THE FOLLOWING ARE DISPLAYED UNDERNEATH THE GAME CANVAS -->
<!-- Display tasks and resource links (when the game is ongoing) -->
  <div class="ongoing" id="taskList">
    <p class="ongoing">Remaining tasks:</p>
    <p class="ongoing" id="unlockComputer">- Unlock the Computer &#128187</p>
    <p class="ongoing" id="makeToast">- Make Toast &#127838 </p>
    <p class="ongoing" id="openFridge">- Open the Fridge &#127859</p>
    <p class="ongoing" id="makeCoffee">- Make Coffee &#9749</p>
  </div>

  <!-- Display ending text and additional resource links (when the game is completed) -->
  <p class="complete">We took inspiration from Capture The Flag (CTF) competitions in designing the puzzles you just solved and tried to make them a bit beginner-friendly. CTF competitions are a great way to learn more about cybersecurity, though they definitely aren't the only way.</p>
  <br class="complete">
  <p class="complete">Or, if you're not into CTFs, some things you can do are generally learn more about operating systems (especially Linux), improve your programming skills, read CTF challenge write-ups, or watch talks from DEF CON (an annual security conference) to get inspired about interesting security topics.</p>
  <br class="complete">
  <p class="complete">Some additional links:</p>
  <p class="complete">- <a href="https://overthewire.org/wargames/">https://overthewire.org/wargames/</a> is a great way to gain confidence navigating the Linux command-line and learning some common code exploits.</p>
  <p class="complete">- <a href="https://picoctf.org/">https://picoctf.org/</a> is a fantastic starting point if you want to dive a bit deeper than our game goes.</p>
  <p class="complete">- <a href="https://ctftime.org/">https://ctftime.org/</a> lists upcoming CTFs if you’re looking for more past picoCTF.</p>
  <br>

  <!-- Display resource guides (always displayed) -->
  <div id="resources">
    <p>Resources</p>
    <p><a href="guides/caesar_ciphers.pdf" target="_blank" rel="noopener noreferrer">On Caesar Ciphers</a></p>
    <p><a href="guides/number_systems_and_ascii.pdf" target="_blank" rel="noopener noreferrer">Number Systems and ASCII</a></p>
    <p><a href="guides/cli.pdf" target="_blank" rel="noopener noreferrer">Navigating a Command-Line Interface</a></p>
  </div>

</body>
</html>